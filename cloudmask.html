<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cloudmask Workflow &mdash; cloudmesh-nlp 4.3.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/readthedocs-custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="MNIST Workflow" href="mnist.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            cloudmesh-nlp
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">What Is Cloudmesh cc?</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstract.html">Extended Abstract</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rest.html">REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest-gui.html">REST GUI Web Browser Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="specifying-workflows.html">Specifying Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="service.html">Service</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="openapi3.html#http://">OpenAPI</a></li>
<li class="toctree-l1"><a class="reference external" href="openapi.json#http://">OpenAPI (json)</a></li>
<li class="toctree-l1"><a class="reference external" href="openapi.yaml#http://">OpenAPI (yaml)</a></li>
<li class="toctree-l1"><a class="reference external" href="py-modindex.html#http://">Python API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="mnist.html">MNIST Workflow</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Cloudmask Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-the-cloudmask-workflow-on-rivanna">Running the Cloudmask Workflow on Rivanna</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributors Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="todos.html">Todo</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgments</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cloudmesh-nlp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Cloudmask Workflow</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/cloudmesh/cloudmesh-nlp/blob/main/docs/source/cloudmask.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cloudmask-workflow">
<h1>Cloudmask Workflow<a class="headerlink" href="#cloudmask-workflow" title="Permalink to this heading"></a></h1>
<p>Cloudmesh cc comes with an example workflow
that runs Cloudmask, which is a program that
develops a model to classify sections of satellite
images. Information regarding Cloudmask can be found at
<a class="reference external" href="https://github.com/laszewsk/mlcommons/tree/main/benchmarks/cloudmask#readme">https://github.com/laszewsk/mlcommons/tree/main/benchmarks/cloudmask#readme</a></p>
<section id="running-the-cloudmask-workflow-on-rivanna">
<h2>Running the Cloudmask Workflow on Rivanna<a class="headerlink" href="#running-the-cloudmask-workflow-on-rivanna" title="Permalink to this heading"></a></h2>
<p>To execute the workflow on UVA’s HPC supercomputer,
Rivanna, first ensure that your UVA Computing ID
is set with the following command, replacing the
X’s with your ID:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>me@mycomputer<span class="w"> </span>$<span class="w"> </span>cms<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">username</span><span class="o">=</span>XXXXXX
</pre></div>
</div>
<p>Then, connect to the UVA Anywhere VPN and then
download the satellite data into your <a class="reference external" href="https://www.rc.virginia.edu/userinfo/storage/non-sensitive-data/#scratch">scratch</a>
directory on Rivanna:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>me@mycomputer<span class="w"> </span>$<span class="w"> </span>cms<span class="w"> </span>vpn<span class="w"> </span>connect
me@mycomputer<span class="w"> </span>$<span class="w"> </span>ssh<span class="w"> </span>rivanna
rivanna<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/scratch/<span class="nv">$USER</span>
rivanna<span class="w"> </span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/laszewsk/mlcommons.git
rivanna<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>mlcommons/benchmarks/cloudmask/target/rivanna
rivanna<span class="w"> </span>$<span class="w"> </span>make<span class="w"> </span>data
<span class="c1"># downloading the data will take a while.</span>
rivanna<span class="w"> </span>$<span class="w"> </span><span class="nb">exit</span>
</pre></div>
</div>
<p>Next, clone the <code class="docutils literal notranslate"><span class="pre">mlcommons</span></code> repository on your local machine
and run the workflow:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>me@mycomputer<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/cm
me@mycomputer<span class="w"> </span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/laszewsk/mlcommons.git
me@mycomputer<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>mlcommons
me@mycomputer<span class="w"> </span>$<span class="w"> </span>pytest<span class="w"> </span>-v<span class="w"> </span>-x<span class="w"> </span>--capture<span class="o">=</span>no<span class="w"> </span>benchmarks/cloudmask/target/rivanna/run_cloudmask_workflow.py
</pre></div>
</div>
<p>The workflow iterates through the five GPUs available
on Rivanna— A100, V100, P100, RTX2080, and K80— and
runs the program three times on each GPU. Each run
trains the model with 10, 30, and 50 epochs for
benchmarking.</p>
<p>Upon completing a run, the logs and benchmarks of the
program can be found in the target folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>me@mycomputer<span class="w"> </span>$<span class="w"> </span>ssh<span class="w"> </span>rivanna
rivanna<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/scratch/<span class="nv">$USER</span>/mlcommons/benchmarks/cloudmask/target
</pre></div>
</div>
<p>Additionally, the generated <code class="docutils literal notranslate"><span class="pre">.h5</span></code> model file can be found in the
home directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rivanna<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/sciml_bench/outputs/slstr_cloud/
</pre></div>
</div>
<p>The program may take a while to run if the resources
on Rivanna are being used by other jobs.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mnist.html" class="btn btn-neutral float-left" title="MNIST Workflow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="contributing.html" class="btn btn-neutral float-right" title="Contributing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Gregor von Laszewski and Jacques Fleischer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>